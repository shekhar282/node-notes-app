<%- include('partials/header'); -%>
<body>
    <nav>
        <nav>
            <div class="nav-wrapper">
                <a href="/" class="brand-logo center">Notes</a>
            </div>
        </nav>
    </nav>
<main>
    <div class="container ">
        <div class="card blue-grey darken-1">
            <div class="card-content">
                <h4 class="center">Login</h4>
                <div id="register-page" class="row">
                    <div class="col s12 z-depth-6 card-panel">
                        <form class="register-form" autocomplete="off" action="/user/register" method="post">
                            <div class="row">
                                <div class="input-field col s12">
                                    <input id="email" type="email" class="validate" name="email" required>
                                    <label for="email">Email</label>

                                </div>
                            </div>
                            <div class="row">
                                <div class='input-field col s12'>
                                    <input class='validate' type='password' name='password' id='password' required />
                                    <label for='password'>Password</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="input-field col s12 center">
                                    <button class="waves-effect waves-light btn">Login</button>
                                </div>
                                <div class="input-field col s12">
                                    <p class="margin center medium-small sign-up">New User? <a
                                            href="/user/register">Sign Up</a></p>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
<%- include('partials/footer'); -%>

<script>
    $('#password').val('');
    const form = document.querySelector('form');

    form.addEventListener('submit', async (e) => {
        e.preventDefault();

        // get values
        const email = form.email.value;
        const password = form.password.value;

        try {
            const res = await fetch('/user/login', {
                method: 'POST',
                body: JSON.stringify({ email, password }),
                headers: { 'Content-Type': 'application/json' }
            });
            const data = await res.json();
            console.log(data);
            location.assign('/notes');

        }
        catch (err) {
            console.log(err);
        }

    });
</script>